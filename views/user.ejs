<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/search-bar.css">

</head>

<body>
  <section>
    <div class="contaner-fluid">

      <div class="action-btn">
        <div class="search-input d-flex justify-content-center">
          <label for="exam-search-label">Search</label>
          <input type="text" id="search" class="form-control" oninput="Search(this.value)">
          <select id="filter-box" class="form-select form-select-sm" aria-label=".form-select-sm example">
            <option id="fname" value="fname" selected>name</option>
            <option id="lname" value="lname">surname</option>
            <option id="gender" value="gender">gender</option>
            <option id="email" value="email">email</option>
            <option id="mobile" value="mobile">mobile</option>
            <option id="enrollment" value="enrollment">enrollment</option>
            <option id="city" value="city">city</option>
            <option id="college" value="college">college</option>
          </select>

        </div>
      </div>

      <div class="user-table warpper m-2">

        <table class="table " id="studenttable" border="1">
          <thead>
            <tr>
              <th>No</th>
              <th scope="col">Fname</th>
              <th scope="col">Lname</th>
              <th scope="col">Gender</th>
              <th scope="col">Email</th>
              <th scope="col">Mobile</th>
              <th scope="col">Enrollment</th>
              <th scope="col">Qualification</th>
              <th scope="col">City</th>
              <th scope="col">Collage</th>
              <th scope="col">BirthDate</th>
              <th scope="col">CreateDate</th>
            </tr>
          </thead>

          <tbody id="table">

            <% for(i=0; i<data.length; i++) {%>
              <tr>
                <td>
                  <%= (i+1)%>
                </td>
                <td>
                  <%= data[i].fname%>
                </td>
                <td>
                  <%= data[i].lname%>
                </td>
                <td>
                  <%= data[i].gender%>
                </td>
                <td>
                  <%= data[i].email%>
                </td>
                <td>
                  <%= data[i].mobile%>
                </td>
                <td>
                  <%= data[i].enrollment%>
                </td>
                <td>
                  <%= data[i].qualification%>
                </td>
                <td>
                  <%= data[i].city%>
                </td>
                <td>
                  <%= data[i].college%>
                </td>
                <td>
                  <%= data[i].birthdate%>
                </td>
                <td>
                  <%= data[i].createdate%>
                </td>
              </tr>
              <% }%>
          </tbody>



        </table>
      </div>
      <%- include('pagination-tab.ejs') %>

    </div>
  </section>
  <%- include('footer.ejs') %>

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous">



  </script>
<script>

  async function Search(str) {

    const flag = document.getElementById("filter-box").value;

    console.log(str);
    console.log(flag);

    var searching = document.getElementById("search").value;
    var res = await fetch(`/student/?search=${str}&flag=${flag}`);
    var data = await res.json();
    var value = data.searchfname;
    var tbody = document.getElementById("table");

    var content = ``;
    let count=1;
    value.forEach(element => {
      content += '<tr>'
      content += `
            <td> ${count}</td>
            <td> ${element.fname} </td>
            <td> ${element.lname} </td>
            <td> ${element.gender} </td>
            <td> ${element.email} </td>
            <td> ${element.mobile} </td>

            <td> ${element.enrollment} </td>
            <td> ${element.qualification} </td>
            <td> ${element.city} </td>
            <td> ${element.college} </td>
            <td> ${element.birthdate} </td>
            <td> ${element.createdate} </td>`;

      content += '</tr>'
      count++;
    });

    
    tbody.innerHTML = content;

  }

  async function filter(value) {

    console.log(value);

    console.log(value.value)
  }
</script>

</html>